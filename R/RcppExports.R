# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Matrix of states
#' 
#' @param P Integer scalar. Number of functions.
#' @return A matrix of size 2^P by P with all the possible
#' (0,1) combinations of functions.
#' @examples
#' states(3)
#' @export
states <- function(P) {
    .Call('phylogenetic_states', PACKAGE = 'phylogenetic', P)
}

#' Leaf probabilities
#' 
#' @param Z A matrix of size \eqn{N\times P}{N*P} with values \code{(0,1,9)}.
#' @param S A matrix of size \eqn{2^P*P} as returned by \code{\link{states}}.
#' @param psi A numeric vector of length 2.
#' @param noffspring A numeric vector of length \eqn{N}. Number of offspring
#' per node.
#' 
#' @export
leaf_prob <- function(Z, S, psi, noffspring) {
    .Call('phylogenetic_leaf_prob', PACKAGE = 'phylogenetic', Z, S, psi, noffspring)
}

#' Gain/Loss probabilities
#' 
#' Generates a 2x2 matrix with gain loss probabilities, with rows and columns
#' corresponding to states (0,1) of parent and offspring respectively.
#' 
#' @param mu A numeric vector of length 2. Gain and Loss probailities.
#' 
#' @return a 2x2 matrix with gain loss probabilities, with rows and columns
#' corresponding to states (0,1) of parent and offspring respectively.
#' @export
gain_loss_prob <- function(mu) {
    .Call('phylogenetic_gain_loss_prob', PACKAGE = 'phylogenetic', mu)
}

#' Root node probabilities
#' 
#' @param pi A numeric vector of length 2 with root node probabilities.
#' @param S A numeric matrix of size 2^PxP with all possible states as
#' generated by \code{\link{states}}
#' 
#' Generates a vector of length 2^P with the root node probabilities
#' per state
#' @export
root_node_prob <- function(pi, S) {
    .Call('phylogenetic_root_node_prob', PACKAGE = 'phylogenetic', pi, S)
}

#' Internal node probabilities
#' 
#' @param Pr Probabilities (already with leaf probs).
#' @param M Gain/Loss probabilities (see equation 4 of math.pdf)
#' @param S States
#' @param noffspring Number of offspring
#' @param offspring List of offspring
#' @export
internal_prob <- function(Pr, M, S, noffspring, offspring) {
    .Call('phylogenetic_internal_prob', PACKAGE = 'phylogenetic', Pr, M, S, noffspring, offspring)
}

#' Computes Log-likelihood
#' 
#' This function computes the log-likelihood of the chosen parameters given
#' a particular dataset. The arguments \code{Z}, \code{offspring}, and
#' \code{noffspring} should be as those returned by \code{\link{get_offspring}}.
#' For complete Maximum Likelihood Estimation see \code{\link{mle}}.
#' 
#' @param Z A numeric matrix of size \eqn{N\times P}{N*P} with the function
#' states of each leaf (experimental data).
#' @param offspring A List of length \eqn{N} with the set of offspring of
#' each node.
#' @param noffspring An integer vector of length \eqn{N} with the number of
#' offspring per node.
#' @param psi A numeric vector of length 2 (see details).
#' @param mu A numeric vector of length 2 (see details).
#' @param Pi A numeric vector of length 2 (see details).
#' 
#' @details
#' The parameters to estimate are described as follows:
#' \enumerate{
#' \item{\code{psi}: A vector of length 2 with \eqn{\psi_0}{psi[0]} and
#' \eqn{\psi_1}{psi[1]}, which are the misclassification probabilities fo
#' \eqn{s_p=0}{s[p]=0} and \eqn{s_p=1}{s[p]=1}
#' respectively.}
#' \item{\code{mu}: A vector of length 2 with \eqn{\mu_0}{mu[0]} and
#' \eqn{\mu_1}{mu[1]} which are the gain and loss probabilities respectively.}
#' \item{\code{Pi}: A vector of length 2 with \eqn{\pi_0}{pi[0]}} and
#' \eqn{\pi_1}{pi[1]}, which for now is specified as \eqn{(1 - \pi_1)}{(1 - pi[0]),
#' which holds the root node probabilities.}
#' }
#' @return A list of class \code{phylo_LogLik} with the following elements:
#' \item{S}{An integer matrix of size \eqn{2^p\times p}{2^p * p} as returned
#' by \code{\link{states}}.}
#' \item{PI}{A numeric vector of size \eqn{2^p} with each given state's root
#' node probabilities.}
#' \item{PSI}{A numeric matrix of size \eqn{G\times 2^p}{G * 2^p} with node/state
#' probabilities only including leaf node probabilities (this is for debugging).}
#' \item{Pr}{A numeric matrix of size \eqn{G\times 2^p}{G * 2^p} with node/state
#' probabilities.}
#' \item{ll}{A numeric scalar with the log-likelihood value given the chosen
#' parameters.}
#' @export
LogLike <- function(Z, offspring, noffspring, psi, mu, Pi) {
    .Call('phylogenetic_LogLike', PACKAGE = 'phylogenetic', Z, offspring, noffspring, psi, mu, Pi)
}

