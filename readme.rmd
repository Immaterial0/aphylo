---
title: "Phylogenetic tree"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Install

Using devtools

```r
devtools::install_github("gvegayon/phylogenetic")
```

## Example

```{r Loading the package}
library(phylogenetic)
```


```{r Reading Data}

# This datasets are included in the package
data("experiment")
data("tree")

head(experiment)
head(tree)
```

```{r Get offsprings}
O <- get_offsprings(
    experiment, "LeafId", 
    tree, "NodeId", "ParentId"
)

# There is no nice print method for now
lapply(O, head)

# We can visualize it
plot(O, vertex.size=5, vertex.label=NA)
```

## Likelihood


```{r Computing likelihood}

# Parameters and data
Z <- as.matrix(experiment[,-4])

psi     <- c(0.020,0.010)
mu      <- c(0.004,.001)
pi_root <- c(1-0.1,.1)

# Computing likelihood
ll1   <- LogLike(Z, O$offsprings, O$noffsprings, psi, mu, pi_root)
lapply(ll1, head)
```

