---
title: "Phylogenetic tree"
output: github_document
---

[![Travis-CI Build Status](https://travis-ci.org/USCbiostats/phylogenetic.svg?branch=master)](https://travis-ci.org/USCbiostats/phylogenetic)
[![AppVeyor Build Status](https://ci.appveyor.com/api/projects/status/github/USCbiostats/phylogenetic?branch=master&svg=true)](https://ci.appveyor.com/project/USCbiostats/phylogenetic)
[![Coverage Status](https://img.shields.io/codecov/c/github/USCbiostats/phylogenetic/master.svg)](https://codecov.io/github/USCbiostats/phylogenetic?branch=master)

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Install

Using devtools

```r
devtools::install_github("USCbiostats/phylogenetic")
```

## Reading data

```{r Loading the package}
library(phylogenetic)
```


```{r Reading Data}

# This datasets are included in the package
data("experiment")
data("tree")

head(experiment)
head(tree)
```

```{r Get offspring}
O <- get_offspring(
    experiment, "LeafId", 
    tree, "NodeId", "ParentId"
)

# There is no nice print method for now
as.phylo(O)

# We can visualize it
plot(O)
plot_LogLike(O)
```

## Simulating annoated trees

```{r}
set.seed(123)
plot(sim_tree(10))
dat <- sim_annotated_tree(200, P=2)
```


## Likelihood


```{r Computing likelihood}
# Parameters and data

psi     <- c(0.020,0.010)
mu      <- c(0.04,.01)
pi_root <- c(1-0.5,.5)

# Computing likelihood
LogLike(dat$experiment, dat$offspring, dat$noffspring, psi, mu, pi_root)

```

# MLE estimation

```{r MLE}
# Using Artificial Bee Colony algorithm
ans0 <- phylo_mle(rep(.2,5), dat, useABC = TRUE, control = list(maxCycle = 50))
ans1 <- phylo_mle(ans0$par, dat)
# Plotting the path
plot(ans0)
```

