---
title: "Untitled"
output:
  pdf_document:
    includes:
      in_header: math_header.tex
---

For leaf nodes we use missclassification probabilities $\psi$, for which we have
$2^p$ different statesm, hence we obtain an $N\times 2^P$ array. Each row is filled with a particular combination of $\{0,1\}^P$, e.g. $x_l = \{0,0,0\}$.

$$
\Prcond{Z=z_l}{X=x_l} = \left\{
\begin{array}{ll}
\prod_p\{\psi_p^\isone{z_{lp}=x_{lp}}(1-\psi_p)^\isone{z_{lp}\neq x_{lp}}\} & \mbox{if }z_{lp}\neq 9 \\
1 & \mbox{otherwise}
\end{array}
\right.
$$

For internal nodes we use gain and loss functions, also defined by a $N\times 2^P$ array. This is conditional on the leaf nodes.

$$
\Prcond{Z=z_n}{X=x_l}\Prcond{X=x_{p(i)j}}  {X_{pa(i)j} = x_{pa(i)j}} =\left\{
\begin{array}{ll}
\mu_0^\isone{x_{ij}=1}(1-\mu_0)^\isone{x_{ij}\neq 1} & \mbox{if }x_{pa(i)j} = 0 \\
\mu_1^\isone{x_{ij}\neq 1}(1-\mu_1)^\isone{x_{ij}= 1} & \mbox{otherwise}
\end{array}
\right.
$$

$$
\sum_i\Prcond{M=m}{X_i=x_i}\Prcond{X=x_{ij}}{X_{pa(i)j}}
$$
